---
layout: post
title: "VueJS 之 “基础篇（一）"
date: 2017-08-26
tag: VueJS 之 “基础篇（一） 
---  
###  涉及知识点: 
> 1.style与class <br>
> 2.vcomputed、directive、filter <br>
> 3.watch 侦听Data数据的变化 <br>
>4.生命周期: beforeCreate、create、beforeMount、mounted、beforeUpdate、updated、destroyed <br>
>5.this.$refs、$el、$data、$watch <br>
>6.v-bind缩写:、v-on缩写@ <br>
### Vue2.0
```bash
 一、Vue的MVVM实现的原理？

    ViewModel是Vue.js的核心，Vue实例是作用于某一个HTML元素上的，这个元素可以是HTML的body元素，也可以是指定了id的某个元素

    DOM Listeners 和 Data Bindings看作两个工具，它们是实现双向绑定的关键。

    从view层来看，ViewModel中的DOM Listeners工具会帮我们监测页面上DOM元素的变化，如果有变化，则更改Model中的数据；

    从Model层来看，当我们更新Model中的数据时，Data Bindings工具会帮我们更新页面中的DOM元素。

二、Vue使用

    1、页面加载vue.js文件  <script src="vue.js"></script>

    2、npm下载vue包, npm install vue --save-dev
```
### 双向绑定
```bash
 <div id="app">
    <input type="text" v-model="message">
    {{ message }}
</div>

new Vue({
    el: '#app',
    data: {
        message: 'hello world'
    }
})
```
### 生命周期

```bash
一、构造器

    1、每个构造器都是通过创建一个Vue的实例启动的

        var vm = new Vue({
            // ...    
        })

    2、扩展构造器

        通过扩展构造器可以创建可复用的组件构造器

        var MyComponent = Vue.extend({
            // 扩展选项
        })

二、生命周期

    1、beforeCreate(): 实例初始化，数据观测(data observer)和事件（event/watcher）配置之前被调用

    2、create(): 实例创建完后被调用，完成了数据观测(data observer)和事件（event/watcher）回调，但还挂载还没开始$el属性不可见

    3、beforeMount(): 在挂载开始之前调用，render()函数被调用

    4、mounted(): el被创建的vm.$el替换，挂载到实例上调用钩子

    5、beforeUpdate(): 数据更新时调用，在虚拟DOM重新渲染

    6、updated(): 数据更改导致虚拟DOM重新渲染

    7、destroyed(): 卸载组件

    <script>
        var vm = new Vue({
            el: '#app',
            data: {
                message: 'siguang'
            },
            methods: {
                showMessage: function(){
                    console.log(this.message);
                },
                deleteVue: function(){
                    vm.$destroy();          // 消毁Vue实例
                }
            },

            // new Vue后执行开始
            beforeCreate: function(){
                console.log('beforeCreate');
            },

            // Vue实例创建被调用
            create: function(){
                console.log('create');
            },


            mounted: function(){
                console.log('mounted');
            },

            // 数据更新后执行的回调
            beforeUpdate: function(){    
                console.log('beforeUpdate');     
            },
            updated: function(){    
                console.log('updated');     
            },

            // 消毁时触发
            destroyed: function(){
                console.log('destroyed');
            }

        });
    </script>
```
### 数据绑定

```bash
一、文本绑定:  <p>{{ data.name }}</p>    与 <p v-text="data.name"></p> 相同

二、html绑定:  <p v-html="data.strHtml"></p>

三、绑定的值可以html中: 

    <div id="item-{{id}}"></div>

    <div :id="userId"></div>

四、表达式: 

五、过滤器:  {{ message | capitalize }}

    连续过滤器:  {{ message | filterA | filterB }}
```
### 常用指令

```bash
指令: 以 v- 开头

    <div v-if="greeting == 1"></div>

    带参数: <a v-bind:href="url"></a>

一、v-if、v-else-if条件渲染: 

    <div v-if="type === 'A'">A</div>
    <div v-else-if="type === 'B'">B</div>
    <div v-else-if="type === 'C'">C</div>
    <div v-else>Not A/B/C</div>

二、v-show: 显示还是隐藏元素，用的display

三、v-for: 循环数据来渲染列表

    $index: 索引        $key: 

    * 数组/数组对象循环: 

        <li v-for="item in items" :key="item">{{ item.message }}</li>

        或者:
        <li v-for="(val, index) in objList" :key="index">
            {{index}}. {{key}} : {{val.type}}
           </li>

    * 对象循环: index下标    key对象的key   val对象属性值

        <li v-for="(val, index) in objList" :key="index">
            {{index}}. {{key}} : {{val.type}}
           </li>

    * filterBy()、orderBy()过滤器

    **** 注意在使用2.2.0以上版本时 ****
    @key是必要属性否则就会报警告

        1）<el-row class="pt20 w50" v-for="method in payMethods" :key="method.label">        // 数据

        2）<el-option
                v-for="(item,index) in payMethods"
                :key="index"
                :label="item.label"
                :value="item.value">
            </el-option>


四、v-model: 绑定值，这也是MVVM的关键点

    可以对文本表单、单选框 、多选框、下拉菜单进行绑定值

    参数特性:

        1）lazy: 不是输入时就进行同步而是在change的时候才对数据进行同步

            <input type="text" v-model="msg" lazy /> {{msg}}

        2）number: 将用户输入的转成Number型，如果返回NaN那就返回原值

        3）debounce: 设置一个最小延时，否则如果输入是ajax请求，每次敲击都会去请求

            <input type="text" debounce="500" v-model="msg">        // 按完键500毫秒后在进行

    获取checkbox值:

        <input type="checkbox" v-model="toggle" v-bind:true-value="a" v-bind:false-value="b">

        // 当选中时
        vm.toggle === vm.a

        // 当没有选中时
        vm.toggle === vm.b


五、v-bind: 绑定到HTML元素上，v-bind:class="active"

    v-bind缩写: ":" <a :href='url'></a>


六、v-on: 用于监听DOM事件 v-on:click="doSomeThing"

    v-on缩写: "@" <div @click="doSomeing"></div>


七、v-ref: 访问子组件

    2.0后 v-el和v-ref合成了一个 ref属性，组件实例中通过 $refs 来调用 

    <div ref="box">xxxx</div>
    <el-button type="primary" slot="append" @click="getRefs">发送</el-button>

    {
        methods:{
            getRefs(){
                console.log(this.$refs.box.innerHTML);
            }
        }
    }

    如果绑定一个元素使用 :ref='item'
    <p v-for="item in items" :ref="item"></p>


八、v-pre: 跳过这个元素和它的子元素的编译过程，这样加快了编译的速度

    <div v-pre>{{ 这里不用框架来编译 }}</div>

九、v-cloak:

十、v-once: 只渲染元素和组件一次，之后的渲染都会跳过次元素

    <span v-once>xxxxx</span>
```
### 过滤器

```bash
过滤器，对绑定值进行处理

一、内置过滤器

    1、uppercase: 字母转成大写

    2、lowercase: 字母转成小写

    3、capitalize: 首字母转成大写

    4、filterBy: 过滤内容

    5、limitBy: 过滤数据从开始到指定位置结束的内容

    6、orderBy: 过滤排序

    7、currency: 货币过滤

    8、debounce: 延迟过滤


二、自定义过滤器和带参数

    <span v-text="message | reverse 'addText' "></span>

    // 创建自己定义过滤器 value值 addText参数
    Vue.filter('reverse', function(value, addText){
        return value.split('').remove().join() + addText:
    })


三、双向过滤器

    模型的值显示在视图之前转换它

    <input v-mode="money | formatMoney">
    <div>{{ money | formatMoney }}</div>

    Vue.filter('formatMoney', {

        // model -> vlew过程  在更新<input> 元素之初化值
        read: function(val){
            return '$' + val.toFixed(2);
        },

        // vlew -> model过程 在写回数据之前格式化值
        write: function(val){
            var number = +val.replace(/[^\d.]/g, '');
            return isNaN(number) ? 0 : parseFloat(number.toFixed(2));
        }
    })


四、动态参数

    参数用空格格开

    <input type="text" v-model="userInput">
    <span>{{msg | concat userInput}}</span>

    Vue.filter('concat', function (value, input) {
        // `input` === `this.userInput`
        return value + input;
    })


五、filterBy过滤器

    <div id="app">
        <div>过滤数据里包含 蛋糕 字符 </div>
        <div class="box">
            <ul>
                <li v-for="user in users | filterBy '蛋糕' ">{{ user.name }}</li>
            </ul>
        </div>

        <div style="margin-top: 30px" >过滤出输入的字符</div>
        <input type="text" name="" v-model="searchKey" />
        <div class="box">
            <ul>
                <li v-for="user in users | filterBy searchKey in 'name'">{{ user.name }}</li>
            </ul>
        </div>
    </div>

    <script src="../../js/vue.js"></script>
    <script type="text/javascript">
        var vm = new Vue({
            el: '#app',
            data: {
                searchKey: '',
                users:[
                    {
                        name: '外卖',
                        tag: 1
                    },
                    {
                        name: '鲜花',
                        tag: 5
                    },
                    {
                        name: '蛋糕',
                        tag: 4
                    },
                    {
                        name: '水果',
                        tag: 2
                    },
                    {
                        name: '茶点',
                        tag: 3
                    }
                ]
            }
        })
    </script>

六、orderBy排序

    <div id="app">
        <input type="text" name="" v-model="searchKey" />
        <div class="box">
            <ul>
                <li v-for="user in users | orderBy 'tag'">{{ user.name }}</li>
            </ul>
        </div>
    </div>

    <script type="text/javascript">
        var vm = new Vue({
            el: '#app',
            data: {
                searchKey: '',
                users:[
                    {
                        name: '外卖',
                        tag: 1
                    },
                    {
                        name: '咖啡',
                        tag: 5
                    },
                    {
                        name: '餐厅订座',
                        tag: 4
                    },
                    {
                        name: '蛋糕',
                        tag: 2
                    },
                    {
                        name: '票务',
                        tag: 3
                    }
                ]
            }
        })
    </script>
```
### 指令

```bash
一、钩子函数

    el：指令所绑定的元素，可以用来直接操作 DOM 。
    binding：一个对象，包含以下属性：
    name：指令名，不包括 v- 前缀。
    value：指令的绑定值，例如：v-my-directive="1 + 1" 中，绑定值为 2。
    oldValue：指令绑定的前一个值，仅在 update 和 componentUpdated 钩子中可用。无论值是否改变都可用。
    expression：字符串形式的指令表达式。例如 v-my-directive="1 + 1" 中，表达式为 "1 + 1"。
    arg：传给指令的参数，可选。例如 v-my-directive:foo 中，参数为 "foo"。
    modifiers：一个包含修饰符的对象。例如：v-my-directive.foo.bar 中，修饰符对象为 { foo: true, bar: true }。
    vnode：Vue 编译生成的虚拟节点。移步 VNode API 来了解更多详情。
    oldVnode：上一个虚拟节点，仅在 update 和 componentUpdated 钩子中可用。

二、对象字面量

    <div v-demoA="{ color: 'white', text: 'hello'}"></div>

    Vue.directive('demoA', function(el, value){
        console.log(value.color);
        console.log(value.text);
    })


三、元素指令，相当于angular的E指令

    Vue.elementDirective('my-directive', {
        bind: function(){
            // 操作this.el
        }
    })

    <my-directive></my-directive>            // 不能这么写<div v-my-directive></div>

四、高级选项

    params: 自动提取绑定元素的这些特性.

    <div v-example a="hi"></div>
    Vue.directive('example', {
        params: ['a'],
        bind: function () {
            console.log(this.params.a);         // -> "hi"
        }
    })
```
### computed 计算属性

```bash
计算属性就是当依赖属性发生变化时，属性的值会自动更新，相关的DOM也会同步更新

一、计算属性的getter

    <div id="app">
        <p>user_inof={{ userInfo }}</p>
    </div>

    <script>
        var vm = new Vue({
            el: '#app',
            data: {
                "user_name": "lulu",
                "user_age": "20"
            },
            computed: {
                // 一个计算属性getter
                userInfo: function(){
                    return '姓名: '+ this.user_name +' 年龄: '+ this.user_age;
                }
            }
        })
    </script>


二、计算属性的setter

    var vm = new Vue({
        el: '#app',
        data: {
            "user_name": "lulu",
            "user_age": "20"
        },
        computed: {
            userInfo: function(){
                get: function(){
                    return '姓名: '+ this.user_name +' 年龄: '+ this.user_age;
                },
                set: function(newValue){        // 这里当
                    this.userInfo = newValue;
                }
            }
        }
    })
```
### watch 侦听数据变化

```bash
watch 侦听data下指定数据的变化 

<script>

    var vm = new Vue({
        el: '#app',
        data: {
            message: 'siguang'
        },
        methods: {
            showMessage: function(){
                console.log(this.message);
            }
        },
        watch:{
            message: function(newValue){
                return newValue + 1;        // 如果message变化值加1
            }
        }
    });

    console.log(vm.message);        // siguang
    vm.showMessage();

    // 写在实例化下侦听数据变化
    // vm.$watch('message', function(newVal, oldVal){
    //    console.log(newVal, oldVal);
    //    this.message = newVal.replace(/s|g/g, '*');
    // })

</script>
```
### class和style的绑定

```bash
一、class

    // 对象
    <div :class="{ 'active': isActive }"></div>

    var vm = new Vue({
        el: '#app',
        data: {
            isActive: true
        }
    })

    // 数组
    <div :class="[activeClass, errorClass]"></div>        // 三元 <div v-bind:class="[isActive ? activeClass : '', errorClass]"></div>
    data: {
        activeClass: 'active',
        errorClass: 'text-danger'
    }    


二、style

    <div :style="[crm, hk]"> 或 <div :style="{color: activeColor, fontSize: fontSize+'px'}">

    var vm = new Vue({
        el: '#app',
        data: {
            activeColor: 'red',
            fontSize: 30,
            crm: {
                color: '#000',
                fontSize: '16px'
            },
            hk: {
                color: '#fff',
                fontSize: '18px'
            }
        }
    })
```
### 事件

```bash
一、@click

    <div @click="say"></div>
    <div @click="say('hi')"></div>
    <div @click="content + 1"></div>


    <!-- 阻止单击事件冒泡 -->
    <a v-on:click.stop="doThis"></a>

    <!-- 提交事件不再重载页面 -->
    <form v-on:submit.prevent="onSubmit"></form>

    <!-- 修饰符可以串联  -->
    <a v-on:click.stop.prevent="doThat"></a>

    <!-- 只有修饰符 -->
    <form v-on:submit.prevent></form>

    <!-- 添加事件侦听器时使用事件捕获模式 -->
    <div v-on:click.capture="doThis">...</div>

    <!-- 只当事件在该元素本身（而不是子元素）触发时触发回调 -->
    <div v-on:click.self="doThat">...</div>

二、按键别名

    .enter、.tab、.delete (捕获 “删除” 和 “退格” 键)、.esc、.space、.up、.down、.left、.right、.ctrl、.alt、.shift、.meta

三、once: 只处理一次点击  <a v-on:click.once="doThis"></a>

四、修饰符 <input v-on:keyup.13="submit">
```
### 模板语法

```bash
Vue在底层将模板编译成虚拟DOM渲染函数，也可以不用模板直接写render函数，可选JSX语法
```
### 常见问题

```bash
一、v-bind 内联字符串连接

    data(){
        return {
            addString: '加入内容'
        }
    }

    1.x版本 写法  <div attr="xxxx{{addString}}">

    2.x版本 写法  <div v-bind="'xxxx'+ addString">


二、checkbox动态创建绑定

    // v-model="item.check" 绑定的值要相同

    <p v-for="item in checkList">
        <input type="checkbox" name="cb" v-model="item.check" /> {{item.name}}
    </p>

    data(){
        return{
            checkList:[
                {check: false, name: 'aa'},
                {check: false, name: 'bb'},
                {check: false, name: 'cc'}
            ]
        }
    }

三、vue使用jxs语法

    new Vue({
        el: '#demo',
        render (h) {
            return (    // 使用这种jsx语法
                <AnchoredHeading level={1}>
                    <span>Hello</span> world!
                </AnchoredHeading>
            )
        }
    })

    需要安装插件

    $ npm install babel-plugin-syntax-jsx babel-plugin-transform-vue-jsx babel-helper-vue-jsx-merge-props babel-preset-en   --save-dev

    .babelrc:
        {
            "presets": ["env"],
            "plugins": ["transform-vue-jsx"]
        }

    https://github.com/vuejs/babel-plugin-transform-vue-jsx


四、vue键盘事件不起作用

    @keyup.enter.native="login"   如果不加.native是不起作用有
```
### 参考资料
> [https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-CN.md#%E5%9F%BA%E4%BA%8E%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91 /]( https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-CN.md#%E5%9F%BA%E4%BA%8E%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/)Vue代码规范

版权归属，汪文涛的博客：[http://gzwwt2016.github.io](http://gzwwt2016.github.io) 谢谢！
